{
  "start": "wakeup",
  "nodes": {
    "wakeup": {
      "id": "wakeup",
      "name": "You",
      "background": "backgrounds/classroom.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "You wake up in a strange classroom. The room is quiet.",
      "hotspots": [
        {
          "id": "desk",
          "label": "Desk",
          "x": 42,
          "y": 62,
          "w": 24,
          "h": 16,
          "action": {
            "type": "dialogue",
            "text": "There's a folded note on the desk.",
            "choices": [
              { "text": "Read the note", "next": "read_note" },
              { "text": "Ignore it", "next": "look_around" }
            ]
          }
        },
        {
          "id": "door",
          "label": "Door",
          "x": 82,
          "y": 38,
          "w": 10,
          "h": 40,
          "action": { "type": "goto", "next": "locked_door" }
        }
      ],
      "choices": [
        { "text": "Look around", "next": "look_around" }
      ]
    },

    "read_note": {
      "id": "read_note",
      "name": "You",
      "background": "backgrounds/classroom.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "The note reads: 'Trust no one.'",
      "setFlag": { "paranoid": true },
      "choices": [
        { "text": "Stand up", "next": "hall" },
        { "text": "Ignore note", "next": "sleep" }
      ]
    },

    "look_around": {
      "id": "look_around",
      "name": "You",
      "background": "backgrounds/classroom.jpg",
      "portrait": "portraits/smile.jpg",
      "text": "You see posters and a locked door.",
      "choices": [
        { "text": "Try the door", "next": "locked_door" },
        { "text": "Read the note", "next": "read_note" }
      ]
    },

    "locked_door": {
      "id": "locked_door",
      "name": "You",
      "background": "backgrounds/hallway.jpg",
      "portrait": "portraits/worried.jpg",
      "text": "The door is locked.",
      "choices": [
        { "text": "Turn around", "next": "mysterious_person" }
      ]
    },

    "mysterious_person": {
      "id": "mysterious_person",
      "name": "???:",
      "background": "backgrounds/hallway.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "'Let's play a game,' a voice whispers.",
      "choices": [
        { "text": "Agree", "next": "ending_good" },
        { "text": "Refuse", "next": "refuse_game" }
      ]
    },

    "refuse_game": {
      "id": "refuse_game",
      "name": "You",
      "background": "backgrounds/hallway.jpg",
      "portrait": "portraits/worried.jpg",
      "text": "You refuse.",
      "choices": [
        { "text": "Back", "next": "wakeup" }
      ]
    },

    "sleep": {
      "id": "sleep",
      "name": "You",
      "background": "backgrounds/classroom.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "You sleep again. (Bad ending)",
      "choices": [
        { "text": "Restart", "next": "wakeup" }
      ]
    },

    "hall": {
      "id": "hall",
      "name": "You",
      "background": "backgrounds/hallway.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "A long hallway stretches ahead.",
      "choices": [
        {
          "text": "Open red door",
          "next": "red_room",
          "requiredFlag": "paranoid",
          "requiredValue": true
        },
        { "text": "Open red door (force)", "next": "red_room_force" },
        { "text": "Go back", "next": "wakeup" }
      ]
    },

    "red_room": {
      "id": "red_room",
      "name": "You",
      "background": "backgrounds/red_room.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "You found a secret lever.",
      "choices": [
        { "text": "Pull lever", "next": "secret_end" }
      ]
    },

    "red_room_force": {
      "id": "red_room_force",
      "name": "You",
      "background": "backgrounds/red_room.jpg",
      "portrait": "portraits/worried.jpg",
      "text": "A trap triggers. (Bad ending)",
      "choices": [
        { "text": "Restart", "next": "wakeup" }
      ]
    },

    "secret_end": {
      "id": "secret_end",
      "name": "Narrator",
      "background": "backgrounds/red_room.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "You discovered a secret. (Good ending)",
      "choices": [
        { "text": "Play again", "next": "wakeup" }
      ]
    },

    "ending_good": {
      "id": "ending_good",
      "name": "Narrator",
      "background": "backgrounds/hallway.jpg",
      "portrait": "portraits/neutral.jpg",
      "text": "The game ends for now.",
      "choices": [
        { "text": "Play again", "next": "wakeup" }
      ]
    }
  }
}
